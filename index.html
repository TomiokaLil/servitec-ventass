<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Registro de Ventas - SERVITEC</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #111;
      color: #fff;
    }
    h1, h2 { text-align: center; color: #ff0000; }
    form {
      background: #222;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0px 2px 6px rgba(255,0,0,0.4);
      max-width: 500px;
      margin: auto;
      color: #fff;
    }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input, select, textarea {
      width: 100%; padding: 8px; margin-top: 5px;
      border: 1px solid #ff0000; border-radius: 5px;
      background: #111; color: #fff;
    }
    button {
      margin-top: 15px; padding: 10px; width: 100%;
      background: #ff0000; color: white; border: none; border-radius: 5px;
      cursor: pointer; font-size: 16px; font-weight: bold;
    }
    button:hover { background: #cc0000; }
    table {
      margin-top: 20px; width: 100%; border-collapse: collapse; background: #222;
    }
    th, td { padding: 10px; border: 1px solid #444; text-align: center; }
    th { background: #ff0000; color: white; }
    td { color: #fff; }
    .container { max-width: 1100px; margin: auto; }
    .acciones button { margin: 2px; padding: 5px 10px; font-size: 14px; border-radius: 5px; border: none; cursor: pointer; }
    .acciones button:first-child { background: #ffaa00; color: #000; }
    .acciones button:last-child { background: #ff0000; color: #fff; }
    #totalVentas { margin-top: 15px; font-weight: bold; font-size: 18px; text-align: right; color: #ff0000; }
    .logo { display:flex; justify-content:center; margin-bottom:20px; }
    .logo img { max-width:150px; }
    #otroDesc, #otroDescPend { display: none; }
    .extra-buttons { display:flex; justify-content:center; gap:10px; margin-top:10px; }
    .extra-buttons button { background:#444; color:white; border:none; padding:8px 12px; border-radius:5px; cursor:pointer; font-size:14px; }
    .extra-buttons button:hover { background:#666; }
  </style>
</head>
<body>
  <div class="logo">
    <img src="logo.png" alt="Logo SERVITEC">
  </div>

  <h1>Registro de Ventas - SERVITEC</h1>
  <div class="container">

    <!-- FORMULARIO VENTAS -->
    <form id="ventaForm">
      <input type="hidden" id="editIndex" value="">

      <label for="nombreCliente">Nombre del Cliente:</label>
      <input type="text" id="nombreCliente" required>

      <label for="telefonoCliente">Tel√©fono del Cliente:</label>
      <input type="tel" id="telefonoCliente" required>

      <label for="tipoTelefono">Tipo de Tel√©fono:</label>
      <input type="text" id="tipoTelefono" required>

      <label for="usuario">Usuario (Empleado):</label>
      <input type="text" id="usuario" required>

      <label for="servicio">Servicio:</label>
      <select id="servicio" required>
        <option value="Cambio de pantalla">Cambio de pantalla</option>
        <option value="Cambio de bater√≠a">Cambio de bater√≠a</option>
        <option value="Desbloqueo">Desbloqueo</option>
        <option value="Mantenimiento general">Mantenimiento general</option>
        <option value="Reparaci√≥n de puerto de carga">Reparaci√≥n de puerto de carga</option>
        <option value="Otro">Otro</option>
      </select>

      <div id="otroDesc">
        <label for="descripcion">Descripci√≥n:</label>
        <textarea id="descripcion" rows="3"></textarea>
      </div>

      <label for="precio">Precio (MXN):</label>
      <input type="number" id="precio" required>

      <label for="fecha">Fecha:</label>
      <input type="date" id="fecha" required>

      <label for="formaPago">Forma de Pago:</label>
      <select id="formaPago" required>
        <option value="Efectivo">Efectivo</option>
        <option value="Tarjeta">Tarjeta</option>
        <option value="Transferencia">Transferencia</option>
        <option value="NO PAGADO">NO PAGADO</option>
      </select>

      <button type="submit">Guardar Venta</button>
    </form>

    <!-- TABLA VENTAS -->
    <h2>Ventas Registradas</h2>
    <table id="tablaVentas">
      <thead>
        <tr>
          <th>Nombre Cliente</th>
          <th>Tel√©fono Cliente</th>
          <th>Equipo</th>
          <th>Usuario</th>
          <th>Servicio</th>
          <th>Precio</th>
          <th>Fecha</th>
          <th>Forma Pago</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div id="totalVentas">Total de Ventas: $0</div>
    <!-- APARTADO TICKET MANUAL -->
    <h2>Generar Ticket Manual</h2>
    <form id="ticketManualForm">
      <label for="nombreManual">Nombre del Cliente:</label>
      <input type="text" id="nombreManual" required>

      <label for="telefonoManual">Tel√©fono:</label>
      <input type="tel" id="telefonoManual">

      <label for="servicioManual">Servicio:</label>
      <input type="text" id="servicioManual" required>

      <label for="precioManual">Precio (MXN):</label>
      <input type="number" id="precioManual" required>

      <label for="formaPagoManual">Forma de Pago:</label>
      <select id="formaPagoManual" required>
        <option value="Efectivo">Efectivo</option>
        <option value="Tarjeta">Tarjeta</option>
        <option value="Transferencia">Transferencia</option>
      </select>

      <button type="submit">üñ®Ô∏è Generar Ticket</button>
    </form>


    <!-- APARTADO PENDIENTES -->
    <h2>
      <button onclick="togglePendientes()" style="background:none; border:none; color:#ff0000; font-size:18px; cursor:pointer;">
        üì¶ Pendientes por Entregar <span id="flechaPend">‚¨áÔ∏è</span>
      </button>
    </h2>

    <div id="pendientesContainer" style="display:none;">
      <form id="pendienteForm">
        <label for="nombreClientePend">Nombre del Cliente:</label>
        <input type="text" id="nombreClientePend" required>

        <label for="telefonoClientePend">Tel√©fono del Cliente:</label>
        <input type="tel" id="telefonoClientePend" required>

        <label for="tipoTelefonoPend">Tipo de Tel√©fono:</label>
        <input type="text" id="tipoTelefonoPend" required>

        <label for="usuarioPend">Usuario (Empleado):</label>
        <input type="text" id="usuarioPend" required>

        <label for="servicioPend">Servicio:</label>
        <select id="servicioPend" required>
          <option value="Cambio de pantalla">Cambio de pantalla</option>
          <option value="Cambio de bater√≠a">Cambio de bater√≠a</option>
          <option value="Mantenimiento general">Mantenimiento general</option>
          <option value="Reparaci√≥n de puerto de carga">Reparaci√≥n de puerto de carga</option>
          <option value="Otro">Otro</option>
        </select>

        <div id="otroDescPend">
          <label for="descripcionPend">Descripci√≥n:</label>
          <textarea id="descripcionPend" rows="3"></textarea>
        </div>

        <label for="precioPend">Precio (MXN):</label>
        <input type="number" id="precioPend" required>

        <label for="fechaPend">Fecha:</label>
        <input type="date" id="fechaPend" required>

        <label for="formaPagoPend">Forma de Pago:</label>
        <select id="formaPagoPend" required>
          <option value="Efectivo">Efectivo</option>
          <option value="Tarjeta">Tarjeta</option>
          <option value="Transferencia">Transferencia</option>
        </select>

        <button type="submit">Agregar Pendiente</button>
      </form>

      <table id="tablaPendientes">
        <thead>
          <tr>
            <th>Nombre Cliente</th>
            <th>Tel√©fono</th>
            <th>Equipo</th>
            <th>Usuario</th>
            <th>Servicio</th>
            <th>Precio</th>
            <th>Fecha</th>
            <th>Forma Pago</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- APARTADO HISTORIAL -->
    <h2>
      <button id="toggleHistorialBtn" onclick="toggleHistorial()" style="background:none; border:none; color:#ff0000; font-size:18px; cursor:pointer;">
        üìú Historial Completo <span id="flecha">‚¨áÔ∏è</span>
      </button>
    </h2>

    <div id="historialContainer" style="display:none;">
      <table id="tablaHistorial">
        <thead>
          <tr>
            <th>Nombre Cliente</th>
            <th>Tel√©fono Cliente</th>
            <th>Equipo</th>
            <th>Usuario</th>
            <th>Servicio</th>
            <th>Precio</th>
            <th>Fecha</th>
            <th>Forma Pago</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="extra-buttons">
        <button onclick="finalizarDia()">üì§ Finalizar D√≠a</button>
        <button onclick="limpiarHistorial()">üóëÔ∏è Limpiar Historial</button>
        <button onclick="borrarVentas()">‚ùå Borrar Ventas</button>
        <button onclick="imprimirResumen()">üñ®Ô∏è Ticket Resumen del D√≠a</button>
      </div>
    </div>

  </div>

  <script>
    // referencias DOM
    const usuarioInput = document.getElementById("usuario");
    const fechaInput = document.getElementById("fecha");
    const tablaBody = document.querySelector("#tablaVentas tbody");
    const historialBody = document.querySelector("#tablaHistorial tbody");
    const pendientesBody = document.querySelector("#tablaPendientes tbody");
    const totalVentasEl = document.getElementById("totalVentas");

    // === PENDIENTES ===
    function togglePendientes() {
      const cont = document.getElementById("pendientesContainer");
      const flecha = document.getElementById("flechaPend");
      if (cont.style.display === "none" || cont.style.display === "") {
        cont.style.display = "block";
        flecha.textContent = "‚¨ÜÔ∏è";
      } else {
        cont.style.display = "none";
        flecha.textContent = "‚¨áÔ∏è";
      }
    }

    document.getElementById("pendienteForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const nombreCliente = document.getElementById("nombreClientePend").value;
      const telefonoCliente = document.getElementById("telefonoClientePend").value;
      const tipoTelefono = document.getElementById("tipoTelefonoPend").value;
      const usuario = document.getElementById("usuarioPend").value;
      const servicio = document.getElementById("servicioPend").value;
      const descripcion = document.getElementById("descripcionPend").value;
      const precio = document.getElementById("precioPend").value;
      const fecha = document.getElementById("fechaPend").value;
      const formaPago = document.getElementById("formaPagoPend").value;

      let pendientes = JSON.parse(localStorage.getItem("pendientes")) || [];
      pendientes.push({ nombreCliente, telefonoCliente, tipoTelefono, usuario, servicio, descripcion, precio, fecha, formaPago });
      localStorage.setItem("pendientes", JSON.stringify(pendientes));

      e.target.reset();
      cargarPendientes();
    });

    function cargarPendientes() {
      let pendientes = JSON.parse(localStorage.getItem("pendientes")) || [];
      pendientesBody.innerHTML = "";
      pendientes.forEach((p, i) => {
        const fila = `<tr>
          <td>${p.nombreCliente}</td>
          <td>${p.telefonoCliente}</td>
          <td>${p.tipoTelefono}</td>
          <td>${p.usuario}</td>
          <td>${p.servicio}${p.descripcion ? " - " + p.descripcion : ""}</td>
          <td>$${p.precio}</td>
          <td>${p.fecha}</td>
          <td>${p.formaPago}</td>
          <td>
            <button onclick="marcarEntregado(${i})">‚úÖ Entregado</button>
            <button onclick="eliminarPendiente(${i})">Eliminar</button>
          </td>
        </tr>`;
        pendientesBody.innerHTML += fila;
      });
    }

    function eliminarPendiente(i) {
      let pendientes = JSON.parse(localStorage.getItem("pendientes")) || [];
      pendientes.splice(i, 1);
      localStorage.setItem("pendientes", JSON.stringify(pendientes));
      cargarPendientes();
    }

    function marcarEntregado(i) {
      let pendientes = JSON.parse(localStorage.getItem("pendientes")) || [];
      const entregado = pendientes.splice(i, 1)[0];
      localStorage.setItem("pendientes", JSON.stringify(pendientes));

      let ventas = JSON.parse(localStorage.getItem("ventas")) || [];
      let historial = JSON.parse(localStorage.getItem("historial")) || [];

      // aseguramos estructura igual que ventas
      const nuevaVenta = {
        nombreCliente: entregado.nombreCliente || "Cliente",
        telefonoCliente: entregado.telefonoCliente || "",
        tipoTelefono: entregado.tipoTelefono || "",
        usuario: entregado.usuario || (usuarioInput.value || "Empleado"),
        servicio: entregado.servicio || "",
        descripcion: entregado.descripcion || "",
        precio: entregado.precio || 0,
        fecha: entregado.fecha || new Date().toISOString().split("T")[0],
        formaPago: entregado.formaPago || "Pendiente"
      };

      ventas.push(nuevaVenta);
      historial.push(nuevaVenta);
      localStorage.setItem("ventas", JSON.stringify(ventas));
      localStorage.setItem("historial", JSON.stringify(historial));

      cargarPendientes();
      cargarVentas();
    }

    // === VENTAS DIRECTAS ===
    document.getElementById("ventaForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const nombreCliente = document.getElementById("nombreCliente").value;
      const telefonoCliente = document.getElementById("telefonoCliente").value;
      const tipoTelefono = document.getElementById("tipoTelefono").value;
      const usuario = usuarioInput.value;
      const servicio = document.getElementById("servicio").value;
      const descripcion = document.getElementById("descripcion").value;
      const precio = document.getElementById("precio").value;
      const fecha = fechaInput.value;
      const formaPago = document.getElementById("formaPago").value;

      let ventas = JSON.parse(localStorage.getItem("ventas")) || [];
      let historial = JSON.parse(localStorage.getItem("historial")) || [];

      const nuevaVenta = { nombreCliente, telefonoCliente, tipoTelefono, usuario, servicio, descripcion, precio, fecha, formaPago };
      ventas.push(nuevaVenta);
      historial.push(nuevaVenta);

      localStorage.setItem("ultimoUsuario", usuario);
      localStorage.setItem("ultimaFecha", fecha);

      localStorage.setItem("ventas", JSON.stringify(ventas));
      localStorage.setItem("historial", JSON.stringify(historial));

      e.target.reset();

      // restaurar valores guardados
      usuarioInput.value = localStorage.getItem("ultimoUsuario") || "";
      fechaInput.value = localStorage.getItem("ultimaFecha") || "";

      cargarVentas();
    });

    // === VENTAS + HISTORIAL ===
    function cargarVentas() {
      const ventas = JSON.parse(localStorage.getItem("ventas")) || [];
      const historial = JSON.parse(localStorage.getItem("historial")) || [];
      tablaBody.innerHTML = "";
      historialBody.innerHTML = "";
      let total = 0;

      ventas.forEach((venta, index) => {
        total += parseFloat(venta.precio) || 0;
        const fila = `<tr>
          <td>${venta.nombreCliente}</td>
          <td>${venta.telefonoCliente}</td>
          <td>${venta.tipoTelefono}</td>
          <td>${venta.usuario}</td>
          <td>${venta.servicio}${venta.descripcion ? " - " + venta.descripcion : ""}</td>
          <td>$${venta.precio}</td>
          <td>${venta.fecha}</td>
          <td>${venta.formaPago}</td>
          <td class="acciones">
            <button onclick="imprimirTicket(${index})">üñ®Ô∏è Ticket</button>
            <button onclick="eliminarVenta(${index})">Eliminar</button>
          </td>
        </tr>`;
        tablaBody.innerHTML += fila;
      });

      historial.forEach((venta) => {
        const filaHist = `<tr>
          <td>${venta.nombreCliente}</td>
          <td>${venta.telefonoCliente}</td>
          <td>${venta.tipoTelefono}</td>
          <td>${venta.usuario}</td>
          <td>${venta.servicio}${venta.descripcion ? " - " + venta.descripcion : ""}</td>
          <td>$${venta.precio}</td>
          <td>${venta.fecha}</td>
          <td>${venta.formaPago}</td>
        </tr>`;
        historialBody.innerHTML += filaHist;
      });

      totalVentasEl.textContent = "Total de Ventas: $" + total.toFixed(2);
    }

    function eliminarVenta(index) {
      let ventas = JSON.parse(localStorage.getItem("ventas")) || [];
      ventas.splice(index, 1);
      localStorage.setItem("ventas", JSON.stringify(ventas));
      cargarVentas();
    }

// === IMPRIMIR TICKET ===
function imprimirTicket(index) {
  let ventas = JSON.parse(localStorage.getItem("ventas")) || [];
  let venta = ventas[index];

  if (!venta) return alert("Venta no encontrada.");

  let ticket = window.open("", "Ticket", "width=300,height=650");
  ticket.document.write(`
    <html>
    <head>
      <title>Ticket</title>
      <style>
        body { font-family: monospace, Arial, sans-serif; font-size: 12px; text-align: center; margin: 5px; }
        .linea { border-top: 1px solid #000; margin: 4px 0; }
        .titulo { font-weight: bold; font-size: 14px; margin: 5px 0; }
        .detalle { text-align: left; margin: 5px; font-size: 12px; }
        .totales { text-align: right; font-weight: bold; }
        .qr { margin-top: 10px; }
        .qr img { max-width: 120px; }
        .politicas { font-size: 9px; text-align: left; margin-top: 10px; }
      </style>
    </head>
    <body>
      <div><img src="logo.png" alt="Logo" style="max-width:100px;"></div>
      <p><strong>SERVITEC</strong></p>
      <p>Calle Emilio Carranza #28 Col. Fresno del Norte</p>
      <p>Fco. I. Madero, Coah</p>
      <p>Tel: 8718968112</p>
      <div class="linea"></div>
      <div class="titulo">TICKET DE VENTA</div>
      <div class="linea"></div>
      <div class="detalle">
        <p>Fecha: ${venta.fecha} &nbsp;&nbsp; Hora: ${new Date().toLocaleTimeString()}</p>
        <p>Ticket No: ${("00000000" + (index+1)).slice(-8)}</p>
        <p>Cliente: ${venta.nombreCliente}</p>
        <p>Tel√©fono: ${venta.telefonoCliente}</p>
        <p>Equipo: ${venta.tipoTelefono}</p>
        <p>Pago: ${venta.formaPago}</p>
      </div>
      <div class="linea"></div>
      <div class="detalle">
        <p>Servicios:</p>
        <p>- ${venta.servicio}${venta.descripcion ? " - " + venta.descripcion : ""}  $${venta.precio}</p>
      </div>
      <div class="linea"></div>
      <p class="totales">TOTAL: $${venta.precio}</p>
      <div class="linea"></div>
      <div class="qr">
        <img src="732a29dc-19b2-4b57-bddf-f96f73a1bb51.png" alt="QR">
      </div>
      <p>¬°Gracias por su compra!</p>
      <div class="linea"></div>
      <div class="politicas">
        <strong>POL√çTICAS DE GARANT√çA</strong><br>
        El servicio t√©cnico cuenta con 
        30 d√≠as de garant√≠a en refacciones.<br>
        1. Solo cubre el arreglo realizado.<br>
        2. Revisiones sin costo.<br>
        3. No aplica en equipos mojados, golpeados o con sellos rotos.<br>
        4. No aplica en software con virus o bloqueos.<br>
        5. El cliente debe revisar al recibirlo.<br>
        6. No hay reclamos despu√©s de 24 hrs.<br>
        7. no nos hacemos responsables por tel√©fonos olvidados que superen los 30 d√≠as de haber sido dejados en reparaci√≥n.<br>
        Consulte reglamento completo en el local.
      </div>
      <script>window.print();<\/script>
    </body>
    </html>
  `);
  ticket.document.close();
}

    // === HISTORIAL ===
    function toggleHistorial() {
      const cont = document.getElementById("historialContainer");
      const flecha = document.getElementById("flecha");
      if (cont.style.display === "none" || cont.style.display === "") {
        cont.style.display = "block";
        flecha.textContent = "‚¨ÜÔ∏è";
      } else {
        cont.style.display = "none";
        flecha.textContent = "‚¨áÔ∏è";
      }
    }

    function limpiarHistorial() {
      if (confirm("¬øSeguro que deseas borrar TODO el historial?")) {
        localStorage.removeItem("historial");
        cargarVentas();
      }
    }

    function borrarVentas() {
      if (confirm("¬øSeguro que deseas borrar todas las ventas registradas?")) {
        localStorage.removeItem("ventas");
        cargarVentas();
      }
    }

    function finalizarDia() {
      let historial = JSON.parse(localStorage.getItem("historial")) || [];
      if (historial.length === 0) {
        alert("No hay historial para exportar.");
        return;
      }

      let contenido = "üìú Historial de Ventas - " + new Date().toLocaleDateString() + "\n\n";
      let total = 0;

      historial.forEach((venta, i) => {
        contenido += `${i+1}. Cliente: ${venta.nombreCliente}\n`;
        contenido += `   Tel√©fono: ${venta.telefonoCliente}\n`;
        contenido += `   Equipo: ${venta.tipoTelefono}\n`;
        contenido += `   Usuario: ${venta.usuario}\n`;
        contenido += `   Servicio: ${venta.servicio}${venta.descripcion ? " - " + venta.descripcion : ""}\n`;
        contenido += `   Precio: $${venta.precio}\n`;
        contenido += `   Forma de Pago: ${venta.formaPago}\n`;
        contenido += `   Fecha: ${venta.fecha}\n\n`;
        total += parseFloat(venta.precio) || 0;
      });

      contenido += "=========================================\n";
      contenido += `üí∞ TOTAL DEL D√çA: $${total.toFixed(2)}\n`;
      contenido += "=========================================\n";

      let blob = new Blob([contenido], { type: "text/plain" });
      let enlace = document.createElement("a");
      enlace.href = URL.createObjectURL(blob);
      enlace.download = "historial_" + new Date().toISOString().split("T")[0] + ".txt";
      enlace.click();

      localStorage.removeItem("historial");
      localStorage.removeItem("ventas");

      cargarVentas();
      alert("‚úÖ D√≠a finalizado: historial y ventas exportados y eliminados. Pendientes conservados.");
    }

    // === OTRO en SERVICIOS (Ventas y Pendientes) ===
    const servicioSelect = document.getElementById("servicio");
    const otroDesc = document.getElementById("otroDesc");
    servicioSelect.addEventListener("change", () => {
      if (servicioSelect.value === "Otro") {
        otroDesc.style.display = "block";
      } else {
        otroDesc.style.display = "none";
        document.getElementById("descripcion").value = "";
      }
    });

    const servicioPend = document.getElementById("servicioPend");
    const otroDescPend = document.getElementById("otroDescPend");
    servicioPend.addEventListener("change", () => {
      if (servicioPend.value === "Otro") {
        otroDescPend.style.display = "block";
      } else {
        otroDescPend.style.display = "none";
        document.getElementById("descripcionPend").value = "";
      }
    });

    // === INICIO ===
    window.addEventListener("load", () => {
      // restaurar usuario/fecha si existen
      if (localStorage.getItem("ultimoUsuario")) {
        usuarioInput.value = localStorage.getItem("ultimoUsuario");
      }
      if (localStorage.getItem("ultimaFecha")) {
        fechaInput.value = localStorage.getItem("ultimaFecha");
      } else {
        // default a hoy
        const hoy = new Date().toISOString().split("T")[0];
        fechaInput.value = hoy;
        document.getElementById("fechaPend").value = hoy;
      }

      cargarPendientes();
      cargarVentas();
    });
  
    // === TICKET MANUAL ===
    document.getElementById("ticketManualForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const nombre = document.getElementById("nombreManual").value;
      const telefono = document.getElementById("telefonoManual").value;
      const servicio = document.getElementById("servicioManual").value;
      const precio = document.getElementById("precioManual").value;
      const formaPago = document.getElementById("formaPagoManual").value;
      const fecha = new Date().toISOString().split("T")[0];
      const hora = new Date().toLocaleTimeString();

      let ticket = window.open("", "TicketManual", "width=300,height=650");
      ticket.document.write(`
        <html><head><title>Ticket Manual</title></head>
        <body style="font-family: monospace; font-size: 12px; text-align:center;">
          <div><img src="logo.png" style="max-width:100px;"></div>
          <p><strong>SERVITEC</strong></p>
          <p><b>Ticket Manual</b></p>
          <hr>
          <p>Fecha: ${fecha} - Hora: ${hora}</p>
          <p>Cliente: ${nombre}</p>
          <p>Tel√©fono: ${telefono}</p>
          <p>Servicio: ${servicio}</p>
          <p>Pago: ${formaPago}</p>
          <hr>
          <h3>TOTAL: $${precio}</h3>
          <hr>
          <p>¬°Gracias por su preferencia!</p>
        El servicio t√©cnico cuenta con 
        30 d√≠as de garant√≠a en refacciones.<br>
        1. Solo cubre el arreglo realizado.<br>
        2. Revisiones sin costo.<br>
        3. No aplica en equipos mojados, golpeados o con sellos rotos.<br>
        4. No aplica en software con virus o bloqueos.<br>
        5. El cliente debe revisar al recibirlo.<br>
        6. No hay reclamos despu√©s de 24 hrs.<br>
        7. no nos hacemos responsables por tel√©fonos olvidados que superen los 30 d√≠as de haber sido dejados en reparaci√≥n.<br>
        Consulte reglamento completo en el local.

          <script>window.print();<\/script>
        </body></html>
      `);
      ticket.document.close();
      e.target.reset();
    });

    // === RESUMEN DEL D√çA ===
    function imprimirResumen() {
      let historial = JSON.parse(localStorage.getItem("historial")) || [];
      if (historial.length === 0) return alert("No hay ventas en el historial.");

      let total = 0;
      let detalles = "";
      historial.forEach((venta, i) => {
        detalles += `<p>${i+1}. ${venta.nombreCliente} - ${venta.servicio}${venta.descripcion ? " - " + venta.descripcion : ""} - $${venta.precio}</p>`;
        total += parseFloat(venta.precio) || 0;
      });

      let ticket = window.open("", "ResumenDia", "width=300,height=650");
      ticket.document.write(`
        <html><head><title>Resumen del D√≠a</title></head>
        <body style="font-family: monospace; font-size: 12px; text-align:center;">
          <div><img src="logo.png" style="max-width:100px;"></div>
          <p><strong>SERVITEC</strong></p>
          <p><b>Resumen del D√≠a</b></p>
          <hr>
          ${detalles}
          <hr>
          <h3>TOTAL DEL D√çA: $${total.toFixed(2)}</h3>
          <hr>
          <p>${new Date().toLocaleDateString()} - ${new Date().toLocaleTimeString()}</p>
          <script>window.print();<\/script>
        </body></html>
      `);
      ticket.document.close();
    }

</script>
</body>
</html>